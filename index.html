<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ECU INFO - Ferramenta definitiva para reparadores de ECU</title>

  <link rel="icon" href="favicon.png" />
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- LOGIN WRAPPER -->
  <div id="login" class="login-wrapper hidden">

    <!-- FORMULÁRIO DE LOGIN -->
    <form id="loginForm" class="login-card">
      <h2>Acessar o ECU Info</h2>
      <p class="form-subtitle">Por favor, digite seu Email e Senha</p>

      <input type="email" name="email" placeholder="Email" required />
      <input type="password" name="password" placeholder="Senha" required />

      <button type="submit">Entrar</button>

      <p class="form-toggle-link">
        Não possui uma conta? 
        <a href="landing.html" id="showRegister">Crie uma agora</a>
      </p>
    </form>

    <!-- FORMULÁRIO DE REGISTRO (escondido inicialmente) -->
    <form id="registerForm" class="login-card hidden">
      <h2>Criar Nova Conta</h2>
      <p class="form-subtitle">É rápido e fácil, comece seu teste de 7 dias.</p>

      <input type="email" name="email" placeholder="Seu melhor email" required />
      <input type="password" name="password" placeholder="Crie uma senha" required />
      <input type="password" name="passwordConfirm" placeholder="Confirme a senha" required />

      <label class="legal-consent">
        <input type="checkbox" name="acceptLegal" id="acceptLegal" required />
        <span>
          Li e concordo com os
          <a href="src/public/termos-de-uso.html" target="_blank" rel="noopener">Termos de Uso</a>
          e a
          <a href="src/public/politica-de-privacidade.html" target="_blank" rel="noopener">Politica de Privacidade</a>.
        </span>
      </label>
      <div class="legal-warning hidden" id="legalWarning">
        Voce precisa marcar o checkbox de aceite para criar sua conta.
      </div>
      <p class="legal-meta" id="registerLegalMeta"></p>

      <button type="submit">Criar Conta</button>

      <p class="form-toggle-link">
        Já possui uma conta? 
        <a href="#" id="showLogin">Faça o login</a>
      </p>
    </form>

  </div>

  <!-- APP (começa escondido) -->
  <div id="app" class="hidden">
    <aside class="sidebar">
      <header class="sidebar-header">
        <h1>ECU INFO - Gerenciamento de ECUs</h1>
        <button id="newModuleBtn">+ Novo Módulo</button>
      </header>
     
      <div class="search-box">
        <input id="moduleSearch" placeholder="Buscar módulos / labels..." />
      </div>

      <ul id="moduleList" class="module-list"></ul>
    </aside>

    <main class="main-area">
      <div class="topbar">
        <div class="topbar-search">
          <label for="quickSearch">Busca rápida</label>
          <input id="quickSearch" placeholder="Buscar por nomes e labels" />
        </div>

        <div class="top-actions">
          <div class="action-group" role="group" aria-label="Acoes do projeto">
            <button id="manageSubscriptionBtn" class="tool">Gerenciar Assinatura</button>
            <button id="saveProjectBtn" class="tool" disabled>Salvar Projetos</button>
            <label class="btn">
              Adicionar Foto
              <input id="photoInput" type="file" accept="image/*" hidden>
            </label>
          </div>

          <div class="mark-tools" role="group" aria-label="Criar Marcacoes">
            <div class="mark-tools-header">
              <div class="mark-tools-title">Criar Marcacoes</div>
              <div class="mark-tools-hint">
                Escolha o tipo de marcacao e clique e mantenha o mouse pressionado por 2 segundos no local desejado.
              </div>
            </div>
            <div class="mark-tools-toggle" role="group" aria-label="Tipo de marcacao">
              <div class="mark-tools-label">Selecione o tipo de marcacao:</div>
              <div class="mark-tools-options">
                <button id="toolPoint" class="tool active">Pino</button>
                <button id="toolText" class="tool">Componente</button>
              </div>
            </div>
          </div>

          <div class="action-group" role="group" aria-label="Sessao">
            <button id="logoutBtn" class="tool danger">Sair</button>
          </div>
        </div>
      </div>

      <section class="editor-wrap">
        <aside class="module-info">
          <div class="field-group">
            <label for="moduleName">Nome do módulo</label>
            <input id="moduleName" placeholder="Digite o nome do módulo aqui" />
            <div class="field-hint">Ex.: ECU Delphi MT80, ABS Bosch 8.0</div>
          </div>
          <div class="field-group">
            <label for="moduleNotes">Notas técnicas</label>
            <textarea id="moduleNotes" placeholder="Adicione observações, testes e detalhes importantes"></textarea>
            <div class="field-hint">Use este espaço para procedimentos, medidas e referências.</div>
          </div>
          <div class="info-actions">
            <button id="deleteModuleBtn" class="danger">Deletar módulo</button>
          </div>
        </aside>

        <div class="stage-wrap">
          <div id="stage" class="stage">
            <div id="stageContent">
              <img id="stageImg" src="" alt="ECU Photo">
              <div id="marksLayer" class="marks-layer"></div>
            </div>
          </div>
          <div class="hint-card">

            <div class="hint">

              Use roda do mouse para zoom • Arraste a imagem segurando botão direito

            </div>

          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- TEMPLATES -->
  <template id="moduleItemTpl">
    <li class="module-item">
      <div class="title"></div>
      <div class="subtitle"></div>
    </li>
  </template>

  <template id="markTpl">
    <div class="mark">
      <div class="dot"></div>
      <div class="label"></div>
    </div>
  </template>

  <!-- MODAL -->
  <div id="mark-modal-overlay" class="modal-overlay hidden">
    <div class="modal-box">
      <h3>Editar Marcação</h3>
      <div class="form-group">
        <label for="mark-title-input">Título:</label>
        <input type="text" id="mark-title-input">
      </div>
      <div class="form-group">
        <label for="mark-desc-input">Descrição:</label>
        <textarea id="mark-desc-input" rows="4"></textarea>
      </div>
      <div class="modal-buttons">
        <button id="btn-delete-mark" class="btn-secondary danger">Deletar Marcação</button>
        <button id="btn-cancel-mark" class="btn-neutral">Cancelar</button>
        <button id="btn-save-mark" class="btn-primary">Salvar</button>
      </div>
    </div>
  </div>

  <div id="legal-modal-overlay" class="legal-modal-overlay hidden" aria-hidden="true">
    <div class="legal-modal" role="dialog" aria-modal="true" aria-labelledby="legal-modal-title">
      <h2 id="legal-modal-title">Atualizamos nossos termos</h2>
      <p class="legal-text">
        Para continuar usando o ECU Info, confirme o aceite dos Termos de Uso e da Politica de Privacidade vigentes.
      </p>
      <div class="legal-version-grid">
        <div class="legal-version">
          <span class="legal-label">Termos de Uso</span>
          <span class="legal-value">Versao: <strong id="legal-terms-version">-</strong></span>
          <span class="legal-value">Vigencia: <strong id="legal-terms-effective">-</strong></span>
        </div>
        <div class="legal-version">
          <span class="legal-label">Politica de Privacidade</span>
          <span class="legal-value">Versao: <strong id="legal-privacy-version">-</strong></span>
          <span class="legal-value">Vigencia: <strong id="legal-privacy-effective">-</strong></span>
        </div>
      </div>
      <label class="legal-consent">
        <input type="checkbox" id="legalAcceptCheckbox" />
        <span>
          Li e concordo com os
          <a href="src/public/termos-de-uso.html" target="_blank" rel="noopener">Termos de Uso</a>
          e a
          <a href="src/public/politica-de-privacidade.html" target="_blank" rel="noopener">Politica de Privacidade</a>.
        </span>
      </label>
      <div class="legal-actions">
        <button id="legalAcceptBtn" class="btn-primary" disabled>Continuar</button>
        <button id="legalLogoutBtn" class="btn-secondary">Sair</button>
      </div>
    </div>
  </div>

  <footer class="global-footer">
    <div class="global-footer-inner">
      <span>ECU Info</span>
      <nav>
        <a href="src/public/termos-de-uso.html" target="_blank" rel="noopener">Termos de Uso</a>
        <a href="src/public/politica-de-privacidade.html" target="_blank" rel="noopener">Politica de Privacidade</a>
      </nav>
    </div>
  </footer>

  <script type="module" src="./src/main.js"></script>

</body>
</html>
