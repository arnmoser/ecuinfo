<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Reative seu acesso ao ECU Info. Diagn√≥sticos r√°pidos e precisos para reparadores automotivos." />
  <title>ECU Info | Reative seu Acesso</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="remarketing.css">
</head>
<body>

<header class="hero">
  <div class="hero-grid"></div>
  <div class="hero-glow"></div>

  <div class="container hero-content">
    <div class="hero-copy">
      <div class="status">
        <span class="dot"></span>
        Teste de 7 dias encerrado
      </div>

      <!-- Bot√£o para login (caso o usu√°rio queira logar primeiro) -->
      <div class="hero-actions" style="margin: 32px 0;">
        <a href="/index.html?from=remarketing#plans" class="btn-primary" style="padding: 14px 32px; font-size: 1rem;">
          Fazer Login
        </a>
      </div>

      <h1>
        Reparador, sua oficina ganhou precis√£o.<br>
        <span>N√£o volte ao caos das buscas manuais.</span>
      </h1>

      <p>
        Seus esquemas el√©tricos, pinagens e anota√ß√µes personalizadas est√£o <strong>salvos e protegidos</strong> no ECU Info. Reative agora e continue diagnosticando ve√≠culos com rapidez, efici√™ncia e sem erros que custam caro.
      </p>

      <!-- Bot√£o principal que inicia checkout (mesmo se n√£o logado) -->
      <a href="#" id="hero-reativar" class="btn-primary">
        Reativar acesso agora
      </a>

      <small class="trust">
        üîí Garantia de reembolso em 7 dias. Sem risco para voc√™.
      </small>
    </div>

    <div class="hero-preview">
      <div class="app-frame">
        <header class="app-header">
          <div class="dots">
            <span></span><span></span><span></span>
          </div>
          <div class="path">ecu-info / acesso pausado</div>
        </header>

        <div class="app-body locked">
          <div class="lock">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
            <strong>Acesso pausado</strong>
            <span>Seus dados t√©cnicos est√£o intactos e prontos</span>
            <button id="lock-reativar">Reativar agora</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<main>

<section class="pain">
  <div class="container pain-grid">
    <div class="pain-copy">
      <h2>
        Voltar para pap√©is soltos, fotos no celular<br>
        e diagn√≥sticos no escuro?
      </h2>
      <p>
        Quem repara m√≥dulo sabe onde o erro come√ßa: informa√ß√£o fragmentada, dados duvidosos e tempo perdido confirmando o √≥bvio.
        O ECU Info centraliza dados t√©cnicos confi√°veis, padroniza o processo de diagn√≥stico e reduz decis√µes baseadas em tentativa e erro.
      </p>
      <p>
        Menos improviso. Mais controle sobre o que voc√™ est√° fazendo.
      </p>
    </div>

    <div class="roi">
      <div>
        <span>Sem ECU Info</span>
        <strong class="neg">Retrabalho, incerteza e perda de tempo</strong>
      </div>
      <div>
        <span>Com ECU Info</span>
        <strong class="pos">Dados organizados e acesso imediato</strong>
      </div>
      <footer>
        <span>Resultado pr√°tico</span>
        <strong>Decis√µes t√©cnicas mais seguras</strong>
      </footer>
    </div>
  </div>
</section>

<section id="plans" class="plans">
  <div class="container">
    <header class="section-head">
      <h2>Escolha o plano que acelera sua oficina</h2>
      <p>Assinatura flex√≠vel, sem burocracia. Foque no que importa: consertar carros.</p>
    </header>

    <div class="plan-grid">
      <article class="plan">
        <h3>Mensal</h3>
        <div class="price">R$ 29,90</div>
        <ul>
          <li>Acesso aos seus esquemas</li>
          <li>Projetos salvos na nuvem</li>
          <li>Compat√≠vel com PC sem instala√ß√£o</li>
        </ul>
        <a href="#" class="btn-outline" data-plan="monthly">Assinar mensal</a>
      </article>

      <article class="plan featured">
        <span class="badge">Mais vantajoso</span>
        <h3>Anual</h3>
        <div class="price">R$ 249 / ano</div>
        <small>Equivalente a R$ 20,75/m√™s ‚Äî Economia de 30%</small>
        <ul>
          <li>Acesso aos seus esquemas</li>
          <li>Projetos salvos na nuvem</li>
          <li>Compat√≠vel com PC sem instala√ß√£o</li>
          <li>Acesso por 1 ano</li>
        </ul>
        <a href="#" class="btn-primary" data-plan="annual">Assinar anual</a>
      </article>
    </div>
  </div>
</section>

<section class="faq">
  <div class="container">
    <h2>D√∫vidas que reparadores como voc√™ t√™m</h2>

    <div class="faq-grid">
      <div>
        <strong>Meus dados sumiram?</strong>
        <p>N√£o. Tudo fica salvo e seguro at√© a reativa√ß√£o.</p>
      </div>
      <div>
        <strong>Posso cancelar quando quiser?</strong>
        <p>Sim, cancelamento f√°cil e imediato, sem multas.</p>
      </div>
    </div>
  </div>
</section>

</main>

<footer class="footer">
  <div class="container">
    <span>ECU Info ‚Äî Solu√ß√µes t√©cnicas para reparadores automotivos</span>
    <nav>
      <a href="termos-de-uso.html">Termos de Uso</a>
      <a href="politica-de-privacidade.html">Politica de Privacidade</a>
    </nav>
  </div>
</footer>

<!-- Integra√ß√£o com pricing-integration.js -->
<script type="module">
  import { supabase } from '../services/supabase.js';
  import { setupPricingButtons, openCustomerPortal } from '../services/pricing-integration.js';

  function scrollToAnchorIfAny() {
    const hash = window.location.hash;
    if (!hash) return;

    const target = document.querySelector(hash);
    if (!target) return;

    requestAnimationFrame(() => {
      target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  }

  async function adaptUIBasedOnUserStatus() {
    const { data: { session } } = await supabase.auth.getSession();

    // 1) N√£o logado ‚Üí modo venda
    if (!session) {
      setupPricingButtons();
      scrollToAnchorIfAny();
      return;
    }

    // 2) Logado ‚Üí checa acesso
    const { data: access, error } = await supabase
      .from('account_access')
      .select('has_access')
      .eq('owner_user_id', session.user.id)
      .single();

    // Se falhou a checagem ‚Üí fallback venda
    if (error) {
      console.error('Error checking user access:', error);
      setupPricingButtons();
      scrollToAnchorIfAny();
      return;
    }

    // 3) Acesso ativo ‚Üí modo gerenciamento
    if (access?.has_access) {
      document.querySelector('.hero-copy .status').innerHTML =
        `<span class="dot active"></span> Assinatura Ativa`;
      document.querySelector('.hero-copy h1').innerHTML =
        'Sua assinatura do ECU Info est√° ativa. üöÄ';
      document.querySelector('.hero-copy p').textContent =
        'Continue aproveitando o acesso ilimitado a todos os diagramas e recursos. Para alterar seu plano ou dados de pagamento, acesse o portal do cliente.';

      document.getElementById('hero-reativar')?.remove();
      document.querySelector('.hero-copy .trust')?.remove();

      const plansSection = document.getElementById('plans');
      if (plansSection) {
        plansSection.innerHTML = `
          <div class="container" style="text-align: center;">
            <header class="section-head">
              <h2>Gerenciar sua assinatura</h2>
              <p>Altere seu plano, atualize sua forma de pagamento ou cancele a qualquer momento.</p>
            </header>
            <button id="manage-subscription-btn" class="btn-primary" style="font-size: 1.1rem; padding: 1rem 2.5rem;">
              Acessar Portal do Cliente
            </button>
          </div>
        `;
        document.getElementById('manage-subscription-btn')
          ?.addEventListener('click', openCustomerPortal);
      }

      scrollToAnchorIfAny(); // se veio com #plans, cai no "gerenciar"
      return;
    }

    // 4) Logado mas expirado ‚Üí modo venda
    setupPricingButtons();
    scrollToAnchorIfAny();
  }

  // Bot√µes do hero/lock sempre empurram para o anual
  function goToPlans() {
  const el = document.getElementById('plans');
  if (!el) return;
  el.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

document.getElementById('hero-reativar')?.addEventListener('click', (e) => {
  e.preventDefault();
  goToPlans();
});

document.getElementById('lock-reativar')?.addEventListener('click', (e) => {
  e.preventDefault();
  goToPlans();
});


  // Executa e garante scroll no final
  adaptUIBasedOnUserStatus().finally(scrollToAnchorIfAny);
</script>


</body>
</html>
